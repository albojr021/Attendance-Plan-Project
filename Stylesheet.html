<script src="https://cdn.tailwindcss.com"></script>
<style>
    /* Custom Styles */
    body { font-family: 'Inter', sans-serif; background-color: #f7f9fc;
    }
    .card { background-color: white; border-radius: 1rem; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05); padding: 1.5rem;
    margin-bottom: 1.5rem; }
    
    /* Status Colors */
    .status-work { 
        background-color: #d1fae5;
        color: #065f46; 
    } 
    .status-rd { background-color: #fee2e2;
    color: #991b1b; } 
    .status-rh { background-color: #dbeafe;
    color: #1e40af; } 
    .status-sh { background-color: #fef3c7;
    color: #92400e; } 
    
    /* Table Cell Structure */
    .cell-container { 
        padding: 0; 
        position: relative; 
    }

    /* Styling para sa Attendance Input field (Schedule) */
    .attendance-input {
        box-sizing: border-box;
        border: none;
        outline: none;
        height: 100%;
        min-width: 50px; 
        text-align: center;
        background-color: transparent;
        transition: background-color 0.2s;
    }
    
    .loading-pulse {
        animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }
    
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: .5; }
    }

    /* --- TABLE STICKY COLUMNS/HEADERS (SCREEN ONLY) --- */
    
    /* General table styling */
    .attendance-grid table {
        table-layout: fixed; /* CRITICAL: Fixed layout for screen */
        width: max-content; 
        min-width: 100%; 
    }

    /* Column Widths for Fixed Employee Info Columns (SCREEN ONLY) */
    .attendance-grid th:nth-child(1), .attendance-grid td:nth-child(1) { width: 50px; }
    .attendance-grid th:nth-child(2), .attendance-grid td:nth-child(2) { width: 120px; }
    .attendance-grid th:nth-child(3), .attendance-grid td:nth-child(3) { width: 200px; }
    .attendance-grid th:nth-child(4), .attendance-grid td:nth-child(4) { width: 120px; }
    .attendance-grid th:nth-child(5), .attendance-grid td:nth-child(5) { width: 120px; }
    
    /* Dynamic Date Cells - EDITED FOR STRICT FIX (SCREEN ONLY) */
    .date-col-fix {
        width: 70px;
        min-width: 70px; 
        max-width: 70px;
        box-sizing: border-box; 
    }

    /* Applying the fix to all headers and data cells starting from the 6th column (SCREEN ONLY) */
    .attendance-grid th:nth-child(n+6), 
    .attendance-grid td:nth-child(n+6) { 
        width: 70px; 
        min-width: 70px;
        max-width: 70px;
        padding: 0; /* Alisin ang padding sa TD/TH at ilagay sa inner DIV */
    }

    /* Apply Sticky Positioning to Headers and Cells (SCREEN ONLY) */
    .sticky-col, .sticky-col-header {
        position: sticky;
        left: 0; 
    }
    .sticky-col-header {
        top: 0; 
        z-index: 20; 
    }
    
    /* Freeze 1: For 'No.' and 'Personnel ID' (SCREEN ONLY) */
    .freeze-1 {
        left: 0;
        z-index: 10;
    }
    .sticky-col-header.freeze-1 {
        z-index: 30;
    }
    
    /* Freeze 2: For 'Personnel Name' (SCREEN ONLY) */
    .freeze-2 {
        /* Total width of Freeze 1 columns: 50px + 120px = 170px */
        left: 170px; 
        z-index: 10;
    }
    .sticky-col-header.freeze-2 {
        z-index: 30;
    }
    
    /* Reset z-index for standard sticky cells (SCREEN ONLY) */
    .attendance-grid td:nth-child(n+4) {
        z-index: 5; 
    }
    
    /* Override sticky position for the first row's second header (Day Name row) (SCREEN ONLY) */
    .attendance-grid tr:nth-child(2) th.sticky-col-header {
        position: static; 
    }

    /* Ensure inner header text has padding, as we removed it from TH above */
    .attendance-grid th {
        box-sizing: border-box; 
    }

    /* Ensure the inner content of the cell takes the color */
    .attendance-cell-bg {
        transition: background-color 0.2s, color 0.2s;
        min-height: 44px; /* Minimum height for touch target */
    }
    
    /* Style for Personnel Info Inputs in the Grid */
    .personnel-info-input {
        box-sizing: border-box;
        border: 1px solid transparent;
        padding: 0.5rem 0.25rem;
        transition: border-color 0.15s, background-color 0.15s;
        min-height: 44px;
    }
    .personnel-info-input:focus {
        border-color: #60a5fa; 
        background-color: #eff6ff; 
        outline: none;
    }
    
    
    /* --- PRINT STYLES --- */

    /* CRITICAL FIX: I-set ang orientation sa Landscape */
    @page {
        size: letter landscape; /* Gawing Landscape ang page orientation */
        margin: 10mm; /* Liitan ang margin para may space */
    }
    
    @media print {
        /* 1. Itago ang lahat ng hindi kailangan */
        .print-hidden, #loading-alert, #notification-area, #floating-status-modal,
        #legend-area /* EXPLICITLY HIDE LEGEND */
        {
            display: none !important;
        }

        /* 2. I-reset ang body at margin */
        body {
            background-color: white !important;
            margin: 0;
            padding: 0 !important;
            font-size: 10pt; /* Default print font size */
        }
        
        /* 3. I-ayos ang Contract Details: Standard Text Style */
        #contract-details-area, #planning-area {
            display: block !important;
            margin-top: 0.5rem;
            padding: 0;
            break-after: avoid; 
        }
        
        /* Alisin ang box shadow at padding ng card para maging malinis */
        .card {
            box-shadow: none !important;
            border-radius: 0 !important;
            padding: 0 !important;
        }
        
        /* CONTRACT DETAILS: REMOVE GRID AND CARD STYLE */
        #contract-details-grid {
            display: block; /* Remove the grid display */
            margin-bottom: 0.5rem; 
            padding: 0;
        }
        
        #contract-details-grid > div {
            /* Gawing standard text line ang bawat detalye */
            display: flex; /* Para magkatabi ang label at value */
            border: none !important; 
            padding: 1px 0 !important; 
            background-color: transparent !important;
            break-inside: avoid;
        }
        
        /* CRITICAL: Gawing mas madali basahin ang label at value */
        #contract-details-grid p,
        #contract-details-grid .text-xl,
        #contract-details-grid .text-lg {
            font-size: 0.65rem !important; /* Liitan pa */
            line-height: 1.2;
            font-weight: normal !important;
            margin: 0;
            padding: 0;
        }
        
        /* Apply BOLD to the label (first p tag) and make it occupy fixed space */
        #contract-details-grid > div p:first-child {
            font-weight: bold !important; /* Label */
            color: #444 !important;
            min-width: 100px; /* Fixed width for alignment */
            margin-right: 5px; 
        }

        /* Itago ang mga blangkong row (logic galing sa JS) */
        .print-empty-row {
            display: none;
        }
        
        /* 4. I-ayos ang Table (Print Grid) */
        
        /* Tanggalin ang overflow para makita ang buong table */
        .print-grid {
            overflow-x: visible !important; 
        }
        
        /* I-alis ang sticky positioning */
        .sticky-col, .sticky-col-header, .freeze-1, .freeze-2 {
            position: static !important;
            left: auto !important;
            z-index: auto !important;
        }
        
        /* CRITICAL: Standard font size para sa table (0.5rem) */
        .attendance-grid table {
            width: 100% !important; 
            table-layout: auto !important; 
            font-size: 0.5rem; /* Standard font size para sa table (~8px) */
            border-collapse: collapse;
        }
        
        /* Header styling */
        .attendance-grid th {
            background-color: #e5e7eb !important; 
            color: #374151 !important;
            padding: 2px 1px !important; 
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
        
        /* CRITICAL: Gawing pare-pareho ang font size sa header elements (0.5rem) */
        .attendance-grid th span,
        .attendance-grid th.text-xs,
        .attendance-grid th.font-semibold {
            font-size: 0.5rem !important;
            font-weight: bold;
        }
        
        /* CRITICAL FIX: Tanggalin ang fixed widths sa print mode para mag-compress ang table */
        .attendance-grid th, 
        .attendance-grid td {
             width: auto !important;
             min-width: 0 !important;
             max-width: none !important;
        }
        
        /* Cell styling */
        .attendance-grid td {
            padding: 0 !important;
            border: 1px solid #e5e7eb;
        }
        
        /* Inner cell content (status/schedule) - pareho ang size (0.5rem) */
        .attendance-cell-bg {
            padding: 1px 1px !important; 
            font-size: 0.5rem !important; 
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
            line-height: 1;
            min-height: 0;
            height: auto;
        }

        /* I-convert ang input fields sa text at gawing 0.5rem */
        .personnel-info-input.print-input-text {
            border: none !important;
            background-color: transparent !important;
            padding: 1px !important;
            color: black !important;
            font-size: 0.5rem !important; /* Pareho ang size */
        }
        
        /* Legend area is now hidden, so this section is not strictly needed but kept for general style */
        /* #legend-area {
            font-size: 0.7rem;
            margin-bottom: 0.5rem !important;
        } */
    }
</style>
